<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Fluffy Robot Dashboard</title>
        <script src="https://unpkg.com/htmx.org@1.9.10"></script>
        <script src="https://go-echarts.github.io/go-echarts-assets/assets/echarts.min.js"></script>
        <link rel="stylesheet" href="static/style.css">
    </head>
    <body hx-headers='{"X-CSRF-Token": "tbd"}'>
        <div class="app-container" id="app-container">
            {{template "nav.html" .}}
            
            <main id="main-content">
                {{template "header.html" .}}
                
                <div id="content-area" 
                     hx-get="/leaderboard" 
                     hx-trigger="load delay:100ms">
                    <!-- Initial content will be loaded here -->
                    <div class="loading">Loading dashboard...</div>
                </div>
            </main>
        </div>

        <footer>
            <p>Spacetraders Credit Report - 2026</p>
            <div class="footer-links">
                <a href="https://github.com/papaburgs/fluffy-robot" target="_blank" rel="noopener noreferrer">GitHub</a>
                <a href="https://railway.com?referralCode=-I-osp" target="_blank" rel="noopener noreferrer">Hosted on Railway</a>
            </div>
        </footer>

        <script>
            // Sidebar Logic
            const appContainer = document.getElementById('app-container');
            const sidebar = document.getElementById('sidebar');
            const toggleBtn = document.getElementById('toggle-sidebar');
            const closeBtn = document.getElementById('close-sidebar');

            const toggleSidebar = () => {
                const isMobile = window.innerWidth <= 768;
                if (isMobile) {
                    sidebar.classList.toggle('open');
                } else {
                    appContainer.classList.toggle('sidebar-collapsed');
                }
            };

            if (toggleBtn) {
                toggleBtn.addEventListener('click', toggleSidebar);
            }

            if (closeBtn) {
                closeBtn.addEventListener('click', () => {
                    sidebar.classList.remove('open');
                });
            }

            // Close sidebar when a link is clicked (on mobile)
            sidebar.addEventListener('click', (e) => {
                if (window.innerWidth <= 768 && e.target.closest('.nav-link')) {
                    sidebar.classList.remove('open');
                }
            });

            // Close sidebar when clicking outside on mobile
            document.addEventListener('click', (e) => {
                if (window.innerWidth <= 768 && 
                    !sidebar.contains(e.target) && 
                    toggleBtn && !toggleBtn.contains(e.target) && 
                    sidebar.classList.contains('open')) {
                    sidebar.classList.remove('open');
                }
            });
        </script>
    </body>
</html>
